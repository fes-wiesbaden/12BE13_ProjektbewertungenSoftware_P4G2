@if (showChangePasswordModal) {
<!-- Overlay -->
<div
  class="fixed inset-0 z-40 bg-black/40"
  (click)="closeChangePasswordModal()"
></div>

<!-- Modal -->
<div
  class="fixed inset-0 z-50 flex items-center justify-center px-4"
>
  <div class="w-full max-w-lg bg-white dark:bg-gray-800 rounded-lg shadow p-6">
    <h2 class="text-lg font-semibold mb-4 text-gray-900 dark:text-white">
      Passwort Ã¤ndern
    </h2>

    <form #changePwdForm="ngForm" (ngSubmit)="submitChangePassword(changePwdForm)" class="space-y-4">
      <!-- Altes Passwort -->
      <div>
        <label
          for="oldPassword"
          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
        >
          Altes Passwort
        </label>
        <input
          type="password"
          id="oldPassword"
          name="oldPassword"
          [(ngModel)]="oldPassword"
          required
          class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                   focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5
                   dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white
                   dark:focus:ring-blue-500 dark:focus:border-blue-500"
        />
      </div>

      <!-- Neues Passwort -->
      <div>
        <label
          for="newPassword"
          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
        >
          Neues Passwort
        </label>
        <input
          type="password"
          id="newPassword"
          name="newPassword"
          [(ngModel)]="newPassword"
          required
          minlength="8"
          class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                   focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5
                   dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white
                   dark:focus:ring-blue-500 dark:focus:border-blue-500"
        />
        <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">
          Mindestens 8 Zeichen empfohlen.
        </p>
      </div>

      <!-- Neues Passwort wiederholen -->
      <div>
        <label
          for="confirmPassword"
          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
        >
          Neues Passwort wiederholen
        </label>
        <input
          type="password"
          id="confirmPassword"
          name="confirmPassword"
          [(ngModel)]="confirmPassword"
          required
          minlength="8"
          class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                   focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5
                   dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white
                   dark:focus:ring-blue-500 dark:focus:border-blue-500"
        />
      </div>

      <!-- Fehlermeldung -->
      <p *ngIf="errorMessage" class="text-sm text-red-600 dark:text-red-400">
        {{ errorMessage }}
      </p>

      <!-- Erfolgsmeldung -->
      <p *ngIf="successMessage" class="text-sm text-green-600 dark:text-green-400">
        {{ successMessage }}
      </p>

      <!-- Buttons -->
      <div class="pt-2 flex justify-end gap-2">
        <button
          type="button"
          (click)="closeChangePasswordModal()"
          class="px-4 py-2 text-sm font-medium rounded-lg border
                   text-gray-700 bg-white hover:bg-gray-100
                   dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"
        >
          Abbrechen
        </button>

        <button
          type="submit"
          [disabled]="changePwdForm.invalid || loading"
          class="inline-flex items-center px-4 py-2 text-sm font-medium text-center text-white
                   bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:ring-blue-300
                   disabled:opacity-50 disabled:cursor-not-allowed
                   dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
        >
          <mat-icon class="w-4 h-4 mr-2">lock</mat-icon>
          <span *ngIf="!loading">Passwort speichern</span>
          <span *ngIf="loading">Speichern...</span>
        </button>
      </div>
    </form>
  </div>
</div>
}
